<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>301 Darts Scorer - Mobile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0c1445, #1a2980, #26c6da);
            font-family: 'Courier New', monospace;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            position: relative;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1.2); }
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            position: relative;
            z-index: 1;
        }

        .screen {
            display: none;
            padding: 15px;
        }

        .screen.active {
            display: block;
        }

        .setup-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .setup-content {
            background: linear-gradient(45deg, #667eea, #764ba2);
            padding: 30px;
            border-radius: 30px;
            text-align: center;
            color: white;
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.5);
            width: 90%;
            max-width: 400px;
        }

        .setup-content h2 {
            font-size: 2rem;
            margin-bottom: 25px;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            color: #ffd700;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            to { text-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.3); }
        }

        .platform-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }

        .platform-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .platform-card:active {
            transform: scale(0.98);
            border-color: #4CAF50;
        }

        .platform-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .platform-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .platform-desc {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.4;
        }

        .setup-form {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            background: rgba(255,255,255,0.9);
            color: #333;
            -webkit-appearance: none;
        }

        .players-list {
            margin-top: 15px;
        }

        .player-input {
            margin-bottom: 15px;
        }

        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 8px;
            width: calc(50% - 16px);
            min-height: 50px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            z-index: 500;
        }

        .btn:active {
            transform: translateY(-2px) scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #f093fb, #f5576c);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
        }

        .btn-full {
            width: calc(100% - 16px);
        }

        .game-board {
            margin-top: 20px;
        }

        .player-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .player-card.active {
            border-color: #ffd700;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            transform: scale(1.02);
        }

        .player-card.inactive {
            opacity: 0.6;
        }

        .player-name {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .player-score {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #00ff88;
            text-align: center;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .current-dart {
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #ffd700;
        }

        .dart-display {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .dart-score {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 12px;
            border-radius: 15px;
            min-width: 40px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dart-board {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .board-numbers {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .number-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .number-label {
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            color: #ffd700;
        }

        .score-buttons {
            display: flex;
            gap: 3px;
        }

        .score-btn {
            flex: 1;
            padding: 8px 4px;
            border: none;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .score-btn.single {
            background: linear-gradient(45deg, #e8f5e8, #c8e6c9);
            color: #2e7d32;
        }

        .score-btn.double {
            background: linear-gradient(45deg, #ffebee, #ffcdd2);
            color: #c62828;
        }

        .score-btn.triple {
            background: linear-gradient(45deg, #e3f2fd, #bbdefb);
            color: #1565c0;
        }

        .score-btn:active {
            transform: scale(0.95);
        }

        .bulls-section {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .bull-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bull-btn.bull {
            background: linear-gradient(45deg, #fff3e0, #ffe0b2);
            color: #ef6c00;
        }

        .bull-btn.cherry {
            background: linear-gradient(45deg, #fce4ec, #f8bbd9);
            color: #ad1457;
        }

        .bull-btn:active {
            transform: scale(0.95);
        }

        .player-controls {
            display: flex;
            gap: 8px;
        }

        .turn-info {
            text-align: center;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .current-turn {
            font-size: 1.3rem;
            margin-bottom: 5px;
            font-weight: bold;
            color: #ffd700;
        }

        .game-controls {
            text-align: center;
            margin-top: 25px;
        }

        .winner-announcement {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            font-size: 1.3rem;
            text-align: center;
            animation: winnerPop 0.8s ease-out;
            box-shadow: 0 20px 50px rgba(255, 215, 0, 0.5);
        }

        @keyframes winnerPop {
            0% { transform: scale(0) rotate(180deg); opacity: 0; }
            70% { transform: scale(1.1) rotate(-10deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); }
        }

        .title-mobile {
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .dart-thrown {
            display: inline-block;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            animation: dartPop 0.5s ease-out;
        }

        @keyframes dartPop {
            0% { transform: scale(0) rotate(-180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(-90deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .round-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .round-total {
            text-align: center;
            font-size: 1.2rem;
            margin-top: 10px;
            color: #ffd700;
        }

        /* Touch-friendly number inputs */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        .stats-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 0.9rem;
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <div class="container">
        <!-- Platform Selection Screen -->
        <div id="platformScreen" class="screen active">
            <div class="logo">🎯 301 Darts</div>
            <h2 style="text-align: center; margin-bottom: 20px;">Choose Platform</h2>
            
            <div class="platform-selection">
                <div class="platform-card" onclick="selectPlatform('desktop')">
                    <div class="platform-icon">🖥️</div>
                    <div class="platform-title">Desktop</div>
                    <div class="platform-desc">Full interface with larger controls</div>
                </div>
                
                <div class="platform-card" onclick="selectPlatform('mobile')">
                    <div class="platform-icon">📱</div>
                    <div class="platform-title">Mobile</div>
                    <div class="platform-desc">Touch-optimized for phones</div>
                </div>
            </div>
        </div>

        <!-- Player Setup Screen -->
        <div id="setupScreen" class="screen">
            <div class="logo">🎯 301 Darts</div>
            <div class="title-mobile" id="platformTitle">Mobile - Setup Players</div>
            
            <div class="setup-form">
                <div class="form-group">
                    <label for="numPlayers">Players (2-4):</label>
                    <input type="number" id="numPlayers" min="2" max="4" value="2" onchange="updatePlayerInputs()">
                </div>
                
                <div class="form-group">
                    <label>Player Names:</label>
                    <div id="playerInputs" class="players-list">
                        <!-- Player inputs will be generated here -->
                    </div>
                </div>
                
                <button class="btn btn-primary btn-full" onclick="startGame()">Start Game</button>
                <button class="btn btn-secondary btn-full" onclick="goBack()">Back</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen">
            <div class="logo">🎯 301 Darts</div>
            
            <div class="turn-info">
                <div class="current-turn"><span id="currentPlayerName"></span>'s Turn</div>
                <div style="font-size: 0.9rem;">Tap the scoring buttons below</div>
            </div>

            <div id="gameBoard" class="game-board">
                <!-- Player cards will be generated here -->
            </div>

            <div class="game-controls">
                <button class="btn btn-secondary" onclick="missBoard()">❌ Miss</button>
                <button class="btn btn-secondary" onclick="bustRound()">💥 Bust</button>
                <button class="btn btn-secondary" onclick="newGame()">🎯 New</button>
                <button class="btn btn-secondary" onclick="goToSetup()">⚙️ Setup</button>
            </div>

            <div id="winnerAnnouncement" class="winner-announcement" style="display: none;">
                🏆 <span id="winnerName"></span> Wins! 🏆
                <div style="margin-top: 15px; font-size: 1rem;">
                    Total Darts: <span id="winnerDarts">0</span><br>
                    Average: <span id="winnerAverage">0.00</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPlatform = '';
        let players = [];
        let currentPlayerIndex = 0;
        let gameInProgress = false;
        let currentDart = {};

        // Create stars background
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }

        function selectPlatform(platform) {
            currentPlatform = platform;
            
            if (platform === 'desktop') {
                alert('Please use the Desktop version artifact for desktop experience.');
                return;
            }
            
            document.getElementById('platformScreen').classList.remove('active');
            document.getElementById('setupScreen').classList.add('active');
            document.getElementById('platformTitle').textContent = 'Mobile - Setup Players';
            
            updatePlayerInputs();
        }

        function updatePlayerInputs() {
            const numPlayers = parseInt(document.getElementById('numPlayers').value);
            const container = document.getElementById('playerInputs');
            container.innerHTML = '';
            
            for (let i = 0; i < numPlayers; i++) {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-input';
                playerDiv.innerHTML = `
                    <input type="text" placeholder="Player ${i + 1}" id="player${i}Name" value="Player ${i + 1}">
                `;
                container.appendChild(playerDiv);
            }
        }

        function startGame() {
            const numPlayers = parseInt(document.getElementById('numPlayers').value);
            players = [];
            
            for (let i = 0; i < numPlayers; i++) {
                const name = document.getElementById(`player${i}Name`).value.trim() || `Player ${i + 1}`;
                players.push({
                    name: name,
                    score: 301,
                    dartsThrown: 0,
                    currentRound: [],
                    roundNumber: 1,
                    scoreAtStartOfTurn: 301,
                    dart1: '',
                    dart2: '',
                    dart3: ''
                });
            }
            
            currentPlayerIndex = 0;
            gameInProgress = true;
            
            // Initialize dart tracking
            initializeDartTracking();
            
            document.getElementById('setupScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            
            renderGameBoard();
            updateCurrentPlayer();
        }

        function renderGameBoard() {
            const gameBoard = document.getElementById('gameBoard');
            gameBoard.innerHTML = '';
            
            players.forEach((player, index) => {
                const playerCard = document.createElement('div');
                playerCard.className = 'player-card';
                playerCard.id = `player${index}Card`;
                
                playerCard.innerHTML = `
                    <div class="player-name">${player.name}</div>
                    <div class="player-score">${player.score}</div>
                    
                    <div class="stats-info">
                        <div class="stats-row">
                            <span>🎯 Darts:</span>
                            <span id="player${index}Darts">${player.dartsThrown}</span>
                        </div>
                        <div class="stats-row">
                            <span>📊 Average:</span>
                            <span id="player${index}Average">0.00</span>
                        </div>
                        <div class="stats-row">
                            <span>🔥 Round:</span>
                            <span id="player${index}Round">${player.roundNumber}</span>
                        </div>
                    </div>
                    
                    <div class="current-dart" id="currentDart${index}">Dart 1</div>
                    <div class="dart-display">
                        <div class="dart-score" id="dart1Score${index}">-</div>
                        <div class="dart-score" id="dart2Score${index}">-</div>
                        <div class="dart-score" id="dart3Score${index}">-</div>
                    </div>
                    
                    <div class="round-info">
                        <div>Current Round:</div>
                        <div id="player${index}CurrentRound"></div>
                        <div class="round-total">Total: <span id="player${index}RoundTotal">0</span></div>
                    </div>
                    
                    <div class="dart-board">
                        <div class="board-numbers">
                            ${generateNumberButtons(index)}
                        </div>
                        <div class="bulls-section">
                            <button class="bull-btn bull" onclick="addScore(${index}, 25)">Bull (25)</button>
                            <button class="bull-btn cherry" onclick="addScore(${index}, 50)">Cherry (50)</button>
                        </div>
                    </div>
                    
                    <div class="player-controls">
                        <button class="btn btn-primary" onclick="submitTurn(${index})" style="flex: 1;">Submit Turn</button>
                        <button class="btn btn-secondary" onclick="clearDarts(${index})" style="flex: 1;">Clear Darts</button>
                    </div>
                `;
                
                gameBoard.appendChild(playerCard);
            });
        }

        function generateNumberButtons(playerIndex) {
            let html = '';
            for (let i = 1; i <= 20; i++) {
                html += `
                    <div class="number-group">
                        <div class="number-label">${i}</div>
                        <div class="score-buttons">
                            <button class="score-btn single" onclick="addScore(${playerIndex}, ${i})">${i}</button>
                            <button class="score-btn double" onclick="addScore(${playerIndex}, ${i * 2})">D${i}</button>
                            <button class="score-btn triple" onclick="addScore(${playerIndex}, ${i * 3})">T${i}</button>
                        </div>
                    </div>
                `;
            }
            return html;
        }

        function addScore(playerIndex, score) {
            if (playerIndex !== currentPlayerIndex) {
                alert("Not this player's turn!");
                return;
            }

            // Initialize current dart for player if not exists
            if (!currentDart[playerIndex]) {
                currentDart[playerIndex] = 1;
            }

            const dartNum = currentDart[playerIndex];
            if (dartNum > 3) {
                alert("All 3 darts thrown! Submit turn or clear.");
                return;
            }

            // Store score at start of turn if first dart
            if (dartNum === 1) {
                players[playerIndex].scoreAtStartOfTurn = players[playerIndex].score;
            }

            // Check for bust conditions
            const newScore = players[playerIndex].score - score;
            if (newScore < 0 || newScore === 1 || (newScore === 0 && score % 2 !== 0)) {
                let bustReason = '';
                if (newScore < 0) bustReason = 'went below zero';
                else if (newScore === 1) bustReason = 'left with 1 (impossible to finish)';
                else if (newScore === 0 && score % 2 !== 0) bustReason = 'finished without a double';
                
                alert(`BUST! (${bustReason})`);
                return;
            }

            // Valid throw - record it
            players[playerIndex][`dart${dartNum}`] = score;
            players[playerIndex].currentRound.push(score);
            
            // Update display
            document.getElementById(`dart${dartNum}Score${playerIndex}`).textContent = score;
            
            // Move to next dart
            currentDart[playerIndex]++;
            if (currentDart[playerIndex] <= 3) {
                document.getElementById(`currentDart${playerIndex}`).textContent = `Dart ${currentDart[playerIndex]}`;
            } else {
                document.getElementById(`currentDart${playerIndex}`).textContent = `Ready to Submit`;
            }

            // Update current round display
            updateCurrentRoundDisplay(playerIndex);
        }

        function updateCurrentRoundDisplay(playerIndex) {
            const currentRoundElement = document.getElementById(`player${playerIndex}CurrentRound`);
            const player = players[playerIndex];
            
            currentRoundElement.innerHTML = '';
            let roundTotal = 0;
            
            player.currentRound.forEach(score => {
                const dartSpan = document.createElement('span');
                dartSpan.className = 'dart-thrown';
                dartSpan.textContent = score === 0 ? 'Miss' : score;
                currentRoundElement.appendChild(dartSpan);
                roundTotal += score;
            });
            
            document.getElementById(`player${playerIndex}RoundTotal`).textContent = roundTotal;
        }

        function submitTurn(playerIndex) {
            if (playerIndex !== currentPlayerIndex) {
                alert("Not this player's turn!");
                return;
            }

            const player = players[playerIndex];
            const roundTotal = player.currentRound.reduce((sum, score) => sum + score, 0);
            
            if (player.currentRound.length === 0) {
                alert("No darts thrown yet!");
                return;
            }

            // Apply the score
            player.score -= roundTotal;
            player.dartsThrown += player.currentRound.length;
            
            // Check for win (must finish on double)
            if (player.score === 0) {
                const lastDart = player.currentRound[player.currentRound.length - 1];
                if (lastDart % 2 === 0 && lastDart > 0) {
                    showWinner(playerIndex);
                    return;
                }
            }

            // Clear round and move to next player
            player.currentRound = [];
            player.roundNumber++;
            clearDarts(playerIndex);
            nextPlayer();
            updateAllStats();
        }

        function clearDarts(playerIndex) {
            players[playerIndex].dart1 = '';
            players[playerIndex].dart2 = '';
            players[playerIndex].dart3 = '';
            players[playerIndex].currentRound = [];
            
            // Reset dart counter
            currentDart[playerIndex] = 1;
            
            // Clear display
            document.getElementById(`dart1Score${playerIndex}`).textContent = '-';
            document.getElementById(`dart2Score${playerIndex}`).textContent = '-';
            document.getElementById(`dart3Score${playerIndex}`).textContent = '-';
            document.getElementById(`currentDart${playerIndex}`).textContent = 'Dart 1';
            document.getElementById(`player${playerIndex}CurrentRound`).innerHTML = '';
            document.getElementById(`player${playerIndex}RoundTotal`).textContent = '0';
        }

        function nextPlayer() {
            currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
            updateCurrentPlayer();
        }

        function updateCurrentPlayer() {
            document.querySelectorAll('.player-card').forEach((card, index) => {
                card.classList.remove('active', 'inactive');
                if (index === currentPlayerIndex) {
                    card.classList.add('active');
                } else {
                    card.classList.add('inactive');
                }
            });
            
            // Reset dart counter for new player
            if (!currentDart[currentPlayerIndex]) {
                currentDart[currentPlayerIndex] = 1;
            }
            
            document.getElementById('currentPlayerName').textContent = players[currentPlayerIndex].name;
        }

        function updateAllStats() {
            players.forEach((player, index) => {
                document.getElementById(`player${index}Darts`).textContent = player.dartsThrown;
                document.getElementById(`player${index}Round`).textContent = player.roundNumber;
                
                if (player.dartsThrown > 0) {
                    const average = ((301 - player.score) / player.dartsThrown).toFixed(2);
                    document.getElementById(`player${index}Average`).textContent = average;
                }
                
                // Update score display
                const scoreElement = document.querySelector(`#player${index}Card .player-score`);
                scoreElement.textContent = player.score;
            });
        }

        function missBoard() {
            const playerIndex = currentPlayerIndex;
            addScore(playerIndex, 0);
        }

        function bustRound() {
            const playerIndex = currentPlayerIndex;
            const player = players[playerIndex];
            
            // Restore score to start of turn
            player.score = player.scoreAtStartOfTurn;
            player.currentRound = [];
            
            clearDarts(playerIndex);
            nextPlayer();
            updateAllStats();
            alert("BUST declared! Score restored.");
        }

        function showWinner(playerIndex) {
            const player = players[playerIndex];
            gameInProgress = false;
            
            document.getElementById('winnerName').textContent = player.name;
            document.getElementById('winnerDarts').textContent = player.dartsThrown;
            document.getElementById('winnerAverage').textContent = ((301 - player.score) / player.dartsThrown).toFixed(2);
            document.getElementById('winnerAnnouncement').style.display = 'block';
        }

        function newGame() {
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('platformScreen').classList.add('active');
            document.getElementById('winnerAnnouncement').style.display = 'none';
            currentPlatform = '';
            players = [];
            currentPlayerIndex = 0;
            gameInProgress = false;
            currentDart = {};
        }

        function goToSetup() {
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('setupScreen').classList.add('active');
            document.getElementById('winnerAnnouncement').style.display = 'none';
        }

        function goBack() {
            document.getElementById('setupScreen').classList.remove('active');
            document.getElementById('platformScreen').classList.add('active');
        }

        // Initialize dart tracking
        function initializeDartTracking() {
            currentDart = {};
            players.forEach((player, index) => {
                currentDart[index] = 1;
            });
        }

        // Initialize the game
        createStars();
        updatePlayerInputs();
    </script>
</body>
</html>
